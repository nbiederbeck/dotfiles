#!/bin/bash

dir=$1

echo "date,lines"

for githash in $(git log --pretty=format:"%h"); do
    git checkout ${githash} -qq;
    printf $(git show --no-patch --no-notes --pretty='%ad' --date=short);
    printf ",";
    tokei ${dir} -t TeX --output json | jq '[.inner.Tex.code][0]';
    git switch - -qq;
done
